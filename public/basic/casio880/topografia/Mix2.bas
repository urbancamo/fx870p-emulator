1 INPUT "XY(1),AZ-D(2),m2(3),D/I(4),ZAP(5),PIES(6),ACUERDOS(7),m3(8),OR(9),D.PAR(10)";A$
2 IF A$="2"THEN GOTO 85
3 IF A$="3" THEN GOTO 185
4 IF A$="4" THEN GOTO 375
5 IF A$="5" THEN GOTO 520
6 IF A$="6" THEN GOTO 610
7 IF A$="7" THEN GOTO 870
8 IF A$="8" THEN GOTO 1200
9 IF A$="9" THEN 1500
10 IF A$="10" THEN 2000
11 PRINT "CAL. COOR.":ANGLE 2
15 INPUT "BASE EN BANCO DE DATOS(S/N)";X$
16 IF X$="S" THEN GOTO 20
17 IF X$="N" THEN GOTO 28
20 INPUT "BASE ESTACION";B$
25 RESTORE# "BASES":RESTORE# B$
26 READ# B$,A,B
27 GOTO 30
28 INPUT "XE";A,"YE";B
30 INPUT "ACIMUT";C,"DISTANCIA";D
40 E=D*SINC:F=D*COSC:G=A+E:H=B+F
50 G=ROUND(G,-4):H=ROUND(H,-4)
60 PRINT "X=";G
70 PRINT "Y=";H:GOTO 30
85 PRINT "AZ-D":ANGLE2
86 INPUT "BASE EN BANCO DE DATOS(S/N)";X$
87 IF X$="S" THEN GOTO 90
88 IF X$="N" THEN GOTO 98
90 INPUT "BASE ESTACION";B$
95 RESTORE# "BASES":RESTORE# B$
96 READ# B$,A,B
97 GOTO 100
98 INPUT "XE";A,"YE";B
100 INPUT "XP";C,"YP";D
110 E=ABS ATN((D-B)/(C-A))
120 IF (C-A)>0 AND (D-B)>0 THEN E=100-E
130 IF (C-A)>0 AND (D-B)<0 THEN E=E+100
140 IF (C-A)<0 AND (D-B)<0 THEN E=300-E
150 IF (C-A)<0 AND (D-B)>0 THEN E=300+E
160 F=SQR((C-A)^2+(D-B)^2)
170 E=ROUND(E,-5):F=ROUND(F,-4)
180 PRINT "AZ=";E;"D=";F:GOTO 100
185 PRINT "SUP."
190 S=0:H=0:I=0
200 INPUT "X1";X,"Y1";Y
210 A=X:B=Y
220 INPUT "X";C,"Y";D
230 H=(D+B)/2:I=C-A
240 J=H*I
250 S=S+J
260 IF C=X GOTO 290
270 A=C:B=D:GOTO 220
280 PRINT "SUP=";S:GOTO 190
290 IF D=Y GOTO 280
300 GOTO 270
375 PRINT "E.DESPLA.":ANGLE2
376 INPUT "BASES EN BANCO DE DATOS(S/N)";X$
377 IF X$="S" THEN GOTO 379
378 IF X$="N" THEN GOTO 383
379 INPUT "BASE ESTACION";B$
380 RESTORE# "BASES":RESTORE# B$
381 READ# B$,A,B
382 GOTO 390
383 INPUT "XE";A,"YE";B
390 INPUT "X EJE";C,"Y EJE";D,"AZ EJE";E,"DIST. I(-)";F
400 IF F<0 THEN J=E-100
410 IF F>0 THEN J=E+100
420 IF J>=400 THEN J=J-400
430 IF J<0 THEN J=J+400
440 G=C+(ABS F*SIN J):H=D+(ABS F*COS J)
450 K=ABS ATN((H-B)/(G-A)):I=SQR((G-A)^2+(H-B)^2)
460 IF (G-A)>0 AND (H-B)>0 THEN K=100-K
470 IF (G-A)>0 AND (H-B)<0 THEN K=K+100
480 IF (G-A)<0 AND (H-B)<0 THEN K=300-K
490 IF (G-A)<0 AND (H-B)>0 THEN K=300+K
500 PRINT "AZ=";ROUND(K,-5),"D=";ROUND(I,-4)
510 GOTO 390
520 PRINT "COOR.ZAPATAS"
530 ANGLE 2
540 INPUT "X ESTACION";A,"Y ESTACION";B
550 INPUT "ACIMUT";C,"DISTANCIA";D
560 E=D*SINC:F=D*COSC
570 G=ROUND(A+E,-4):H=ROUND(B+F,-4)
580 PRINT "X PUNTO=";G
590 PRINT "Y PUNTO=";H
600 A=G:B=H:GOTO 550
610 INPUT "REPLANTEO BORDES(1):PERFILES(2)";O$:ANGLE2
611 INPUT "BASE EN BANCO DE DATOS(S/N)";X$
612 IF X$="N" THEN GOTO 620
613 INPUT "BASE ESTACION";BE$
614 RESTORE#
615 RESTORE#"BASES":RESTORE# BE$
616 READ# BE$,XB,YB,ZB
618 GOTO 621
620 INPUT "XBASE";XB,"YBASE";YB,"ZBASE";ZB,"I";AP
621 INPUT "I";AP
630 INPUT "TALUD DES.";TD,"TALUD TERR.";TT,"ANCHO CUNETA";AC
640 INPUT "XEJE";XE,"YEJE";YE,"AZEJE";AZ
650 IF O$="2" THEN 670
660 INPUT "ANCHO";PA,"COTA";RP,"SOBREANCHO";SA
670 INPUT "DIST.PTO";DP,"AZ.PTO";AH,"DESNV.PTO";D,"JALON";J
680 XP=(SIN(AH)*DP)+XB:YP=(COS(AH)*DP)+YB:ZP=ZB+AP+D-J
690 X=XP-XE:Y=YP-YE:EP=SQR(X^2+Y^2)
700 IF SGNX=+1;IF SGN Y=+1 THEN Z=ASN(ABSX/EP):GOTO 740
710 IF SGN X=+1;IF SGN Y=-1THEN Z=ASN(ABSY/EP)+100:GOTO 740
720 IF SGN X=-1;IF SGN Y=-1THEN Z=ASN(ABSX/EP)+200:GOTO 740
730 Z=ASN(ABSY/EP)+300
740 AG=Z-AZ:A=COS(AG)*EP:B=SIN(AG)*EP:SET F2
750 IF SGN A=+1THEN PRINT "DESPUES DE PK=";A ELSE PRINT "ANTES DE PK=";ABS A
760 IF SGNB=+1THEN PRINT "D.EJE(DCH)=";B ELSE PRINT "D.EJE(IZQ)=";ABS B
770 PRINT "COTA=";ZP:IF O$="1" THEN 790
780 INPUT "NUEVO PK(S/N)";F$
785 IF F$="S" THEN 640 ELSE 670
790 DI=RP-ZP:IF SGN DI=+1 THEN DBT=PA+SA+(DI*TT):GOTO 810
800 DBT=PA+SA+ABS(DI*TD)+AC
810 DID=DBT-(ABS B)
820 IF SGN DID=+1 THEN PRINT "ALEJARSE=";DID ELSE PRINT "ACERCARSE=";DID
830 IF SGN DI=+1 THEN PRINT "SUBIR=";DI ELSE PRINT "BAJAR=";ABS DI
840 PRINT "D.EJE T="DBT:CLS
850 INPUT "OTRO PK(S/N)";Z$:IF Z$="S" THEN 640
860 INPUT "MISMO LADO (S/N)";C$:IF C$="S" THEN 670 ELSE 660
870 PRINT "ACUERDO VERTICAL"
880 INPUT "XV";A,"YV";B,"PE%";C,"PS%";D
890 C=C/100:D=D/100
900 INPUT "KV(+/-)";E
910 F=ABS(C-D):G=ABS E
920 H=G*F/2:I=A-H:J=A+H
930 K=B-H*C:L=B+H*D
940 PRINT "TE=";I;" ";"Z=";K,"TS=";J;" ";"Z=";L
950 PRINT "B=";E*F^2/8;" ";"L=";H*2
960 INPUT "INTERVALO(1) O PK(2)";R$
970 IF R$="2" THEN GOTO 990
980 INPUT "INTERVALO";S
990 INPUT "PK=";M:V=1:IF R$="2" THEN S=0
995 IF V=1THEN GOTO 1015
1010 M=M+S
1015 V=V+1
1020 IF M=0 THEN 900
1030 IF (M>J) THEN 990
1040 IF (M<I) THEN 990
1050 N=(M-I)^2/(2*E):O=K+(M-I)*C
1060 P=O+N:Q=((M-I)*(D-C)/(2*H)+C)*100
1070 SET N
1080 PRINT "PK=";M;" ";"Z=";P;" ";"P=";Q;"%"
1090 X=-C*2*H/(D-C):X=A-H+X
1095 PRINT X
1100 IF R$="2" THEN GOTO 990
1110 GOTO 1010
1200 PRINT "CUBICACION"
1210 CLEAR
1220 INPUT "SUP";AA
1230 INPUT "SUP";BB
1240 INPUT "DIST";DD
1250 V=((AA+BB)/2)*DD
1260 AA=BB
1270 T=T+V
1280 PRINT "V=";V
1290 GOTO 1230
1500 CLS:PRINT "CALCULO ORIENTACION"
1510 INPUT "BASE ESTACION";B$
1520 RESTORE# "BASES":RESTORE# B$
1560 READ# B$,A,B
1570 INPUT "BASE A ORIENTAR";O$
1575 RESTORE#
1600 RESTORE# "BASES":RESTORE# O$
1605 READ# O$,D,E
1610 AZ=ABS ATN((E-B)/(D-A)
1620 IF (D-A)>0 AND (E-B)>0 THEN AZ=100-AZ
1630 IF (D-A)>0 AND (E-B)<0 THEN AZ=AZ+100
1640 IF (D-A)<0 AND (E-B)<0 THEN AZ=300-AZ
1650 IF (D-A)<0 AND (E-B)>0 THEN AZ=300+AZ
1660 F=SQR((D-A)^2+(E-B)^2)
1670 AZ=ROUND(AZ,-5):F=ROUND(F,-4)
1680 PRINT "AZ=";AZ;"D=";F
1690 GOTO 1500
2000 PRINT "D.PARCIALES"
2005 CLEAR :INPUT "XINICIO";A,"YINICIO";B
2100 INPUT "XPTO SIGUIENTE";C,"YPTO SIGUIENTE";D
2105 IF C=0 GOTO 2190
2110 E=ABS ATN((D-B)/(C-A))
2120 IF (C-A)>0 AND (D-B)>0 THEN E=100-E
2130 IF (C-A)>0 AND (D-B)<0 THEN E=E+100
2140 IF (C-A)<0 AND (D-B)<0 THEN E=300-E
2150 IF (C-A)<0 AND (D-B)>0 THEN E=300+E
2160 F=SQR((C-A)^2+(D-B)^2)
2170 E=ROUND(E,-5):F=ROUND(F,-4)
2180 PRINT "AZ=";E;"D=";F:A=C:B=D:DTOTAL=DTOTAL+F:GOTO 2100
2190 PRINT "DISTANCIA ACUMULADA..";DTOTAL
2200 GOTO 2005

