1 PRINT "CALCULO DE R.T.H. por Pepe Casado "
2 CLS:CLEAR:SET N:MODE 6
3 INPUT "NUMERO DE PUNTOS=",A
4 DIM B(A),C(A),D(A),E(A),L(A),M(A),O(A),P(A),Q(A),S(A),U(A),V(A),R(A),H(A)
6 PRINT "COORDENADAS SISTEMA 1":CLS
7 FOR I=1 TO A
8 PRINT "PUNTO"I""
10 LOCATE0,0:LOCATE0,1:INPUT"X=",B(I):LOCATE0,0:LOCATE15,1:INPUT"Y=",C(I):CLS
15 F=B(I)+F:G=C(I)+G
20 NEXT I
25 PRINT "COORDENADAS SISTEMA 2":CLS
30 FOR I=1 TO A
35 PRINT "PUNTO"I""
40 LOCATE0,0:LOCATE0,1:INPUT"X=",D(I):LOCATE0,0:LOCATE15,1:INPUT"Y=",E(I):CLS
45 J=D(I)+J:K=E(I)+K
50 NEXT I
51 XM=F/A:YM=G/A:XMM=J/A:YMM=K/A
52 LOCATE0,0:PRINT"Xm1=",XM:LOCATE15,0:PRINT"Ym1=",YM
53 LOCATE0,0:LOCATE0,1:PRINT"Xm2=",XMM:LOCATE0,0:LOCATE15,1:PRINT"Ym2=",YMM
55 FOR I=1 TO A
60 L(I)=B(I)-XM:M(I)=C(I)-YM:O(I)=SQR((L(I)^2)+(M(I)^2)):P(I)=ATN(L(I)/M(I))
62 IF M(I)<0 THEN P(I)=P(I)+200:IF P(I)<0 THEN P(I)=P(I)+400
65 Q(I)=D(I)-XMM:S(I)=E(I)-YMM:U(I)=SQR((Q(I)^2)+(S(I)^2)):V(I)=ATN(Q(I)/S(I))
67 IF S(I)<0 THEN V(I)=V(I)+200:IF V(I)<0 THEN V(I)=V(I)+400
70 R(I)=P(I)-V(I):H(I)=O(I)/U(I)
75 X=R(I)+X:Y=H(I)+Y:TX=XM-XMM:TY=YM-YMM
80 NEXT I
85 PRINT "SISTEMA 1":CLS
90 FOR I=1 TO A
95 PRINT "PUNTO"I""
100 LOCATE0,0:LOCATE0,1:PRINT"Dx=",L(I):LOCATE0,0:LOCATE15,1:PRINT"Dy=",M(I):CLS
105 LOCATE0,0:LOCATE0,1:PRINT"Dis=",O(I):LOCATE0,0:LOCATE15,1:PRINT"Aci=",P(I):CLS
110 NEXT I
115 PRINT "SISTEMA 2":CLS
120 FOR I=1 TO A
125 PRINT "PUNTO"I""
130 LOCATE0,0:LOCATE0,1:PRINT"Dx=",Q(I):LOCATE0,0:LOCATE15,1:PRINT"Dy=",S(I):CLS
135 LOCATE0,0:LOCATE0,1:PRINT"Dis=",U(I):LOCATE0,0:LOCATE15,1:PRINT"Aci=",V(I):CLS
140 NEXT I
145 PRINT "PARCIALES ROTACION-HOMOTECIA":CLS
150 FOR I=1 TO A
155 PRINT "PUNTO"I""
160 LOCATE0,0:LOCATE0,1:PRINT"R=",R(I):LOCATE0,0:LOCATE15,1:PRINT"H=",H(I):CLS
165 NEXT I
170 PRINT "ROTACION=";X/A
175 PRINT "TRASLACION  X=;TX,"Y=";TY
180 PRINT "HOMOTECIA=";Y/A
190 INPUT "PASAR ALGUN PUNTO? 1s/2n",N
200 ON N GOTO 203,END
203 INPUT"S1=>S2 o S2=>S1 1/2..";N
205 ON N GOTO 210,330
